# bilibili-ai-bot

## todo

- [x] 跑通**获取bv号-b站api-cc字幕文本-openai接口-返回内容**链路
- [x] 接入[b站机器人](https://github.com/hutaoloveu/bilibili-bot-example)
- [ ] 存**db**或者**redis api**调用结果复用

## 业务逻辑
- [x] 客户在 bilibili 网站某视频下方 @AI小乌龟-视频助理
- [x] 项目获取请求对应视频的BV号，并采用布隆过滤器判断 @AI小乌龟-视频助理 是否对该视频进行回复
- [x] 若AI小乌龟已对该视频进行回复，不进行后续处理；若没有对该视频进行回复，项目从CC字幕获取该视频文字版内容，并调用AI大模型（ChatGPT）端口，对用户请求进行处理。
- [x] 将返回得到的 Response 在对应视频下方回复对应客户

## Q&A
  Q：布隆过滤器是什么，它在这里发挥了什么样的作用？

  A：布隆过滤器（Bloom Filter）是一种数据结构，用于快速检查一个元素是否属于某个集合中。它可以快速判断一个元素是否在一个大型集合中，且判断速度很快且不占用太多内存空间。它在网络爬虫、Redis数据库中广泛使用。
  在 bilibili 业务场景中，每个视频只需要@AI小乌龟一次，所有用户都能看到@AI小乌龟的回复，且每个BV号仅对应一个视频，切合布隆过滤器数据结构。

  Q：为什么不使用HashSet、Redis数据库、MySQL，而使用布隆过滤器。
  
  A：HashSet数据结果也可以存储BV号，且不存在误判。但是HashSet会占用较大的存储空间，对象被存储到哈希函数映射到的桶;布隆过滤器不存储关联的对象，采用bit位图判断对应是否存在。

  Q：项目使用的AI大模型是哪个，为什么使用这个？
  
  A：项目使用的是 chatGPT3.5 turbo，这是目前世面上性价比最高，token单价最低的选择。

  Q：在项目中，是否对数据进行了持久化处理（数据库）？如何实现的？

  A：项目使用了MySQL进行数据持久化，存储的数据包括（BvID, content, userId）。
  1) 项目使用Spring框架@PostConstruct注解，将数据库中BV号加载至布隆过滤器，它会在Spring容器的启动时自动的执行。
  2) MySQL中userId等信息用于后续设计过程中 用户限流, 用户个性化分析等功能。
  3) MySQL中数据存储过程为异步执行。